<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Ink/UI/Droppable/1/lib.js - Ink.js</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="../yuidoclogo.png" title="Ink.js"></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: latest</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="../classes/Ink.html">Ink</a></li>
            
                <li><a href="../classes/Ink.Dom.Browser.html">Ink.Dom.Browser</a></li>
            
                <li><a href="../classes/Ink.Dom.Css.html">Ink.Dom.Css</a></li>
            
                <li><a href="../classes/Ink.Dom.Element.html">Ink.Dom.Element</a></li>
            
                <li><a href="../classes/Ink.Dom.Event.html">Ink.Dom.Event</a></li>
            
                <li><a href="../classes/Ink.Dom.FormSerialize.html">Ink.Dom.FormSerialize</a></li>
            
                <li><a href="../classes/Ink.Dom.Loaded.html">Ink.Dom.Loaded</a></li>
            
                <li><a href="../classes/Ink.Dom.Selector.html">Ink.Dom.Selector</a></li>
            
                <li><a href="../classes/Ink.Namespace.ClassModule.html">Ink.Namespace.ClassModule</a></li>
            
                <li><a href="../classes/Ink.Namespace.StaticModule.html">Ink.Namespace.StaticModule</a></li>
            
                <li><a href="../classes/Ink.Net.Ajax.html">Ink.Net.Ajax</a></li>
            
                <li><a href="../classes/Ink.Net.JsonP.html">Ink.Net.JsonP</a></li>
            
                <li><a href="../classes/Ink.UI.Animate_1.html">Ink.UI.Animate_1</a></li>
            
                <li><a href="../classes/Ink.UI.Carousel_1.html">Ink.UI.Carousel_1</a></li>
            
                <li><a href="../classes/Ink.UI.Close.html">Ink.UI.Close</a></li>
            
                <li><a href="../classes/Ink.UI.Common.html">Ink.UI.Common</a></li>
            
                <li><a href="../classes/Ink.UI.DatePicker.html">Ink.UI.DatePicker</a></li>
            
                <li><a href="../classes/Ink.UI.Draggable.html">Ink.UI.Draggable</a></li>
            
                <li><a href="../classes/Ink.UI.Dropdown.html">Ink.UI.Dropdown</a></li>
            
                <li><a href="../classes/Ink.UI.Droppable.html">Ink.UI.Droppable</a></li>
            
                <li><a href="../classes/Ink.UI.FormValidator.html">Ink.UI.FormValidator</a></li>
            
                <li><a href="../classes/Ink.UI.FormValidator_2.html">Ink.UI.FormValidator_2</a></li>
            
                <li><a href="../classes/Ink.UI.ImageQuery.html">Ink.UI.ImageQuery</a></li>
            
                <li><a href="../classes/Ink.UI.Modal.html">Ink.UI.Modal</a></li>
            
                <li><a href="../classes/Ink.UI.Pagination.html">Ink.UI.Pagination</a></li>
            
                <li><a href="../classes/Ink.UI.ProgressBar.html">Ink.UI.ProgressBar</a></li>
            
                <li><a href="../classes/Ink.UI.SmoothScroller.html">Ink.UI.SmoothScroller</a></li>
            
                <li><a href="../classes/Ink.UI.SortableList.html">Ink.UI.SortableList</a></li>
            
                <li><a href="../classes/Ink.UI.Spy.html">Ink.UI.Spy</a></li>
            
                <li><a href="../classes/Ink.UI.Stacker_1.html">Ink.UI.Stacker_1</a></li>
            
                <li><a href="../classes/Ink.UI.Sticky.html">Ink.UI.Sticky</a></li>
            
                <li><a href="../classes/Ink.UI.Swipe.html">Ink.UI.Swipe</a></li>
            
                <li><a href="../classes/Ink.UI.Table.html">Ink.UI.Table</a></li>
            
                <li><a href="../classes/Ink.UI.Tabs.html">Ink.UI.Tabs</a></li>
            
                <li><a href="../classes/Ink.UI.TagField.html">Ink.UI.TagField</a></li>
            
                <li><a href="../classes/Ink.UI.Toggle.html">Ink.UI.Toggle</a></li>
            
                <li><a href="../classes/Ink.UI.Tooltip.html">Ink.UI.Tooltip</a></li>
            
                <li><a href="../classes/Ink.UI.TreeView.html">Ink.UI.TreeView</a></li>
            
                <li><a href="../classes/Ink.Util.Array.html">Ink.Util.Array</a></li>
            
                <li><a href="../classes/Ink.Util.BinPack.html">Ink.Util.BinPack</a></li>
            
                <li><a href="../classes/Ink.Util.Cookie.html">Ink.Util.Cookie</a></li>
            
                <li><a href="../classes/Ink.Util.Date.html">Ink.Util.Date</a></li>
            
                <li><a href="../classes/Ink.Util.Dumper.html">Ink.Util.Dumper</a></li>
            
                <li><a href="../classes/Ink.Util.I18n.html">Ink.Util.I18n</a></li>
            
                <li><a href="../classes/Ink.Util.Json.html">Ink.Util.Json</a></li>
            
                <li><a href="../classes/Ink.Util.String.html">Ink.Util.String</a></li>
            
                <li><a href="../classes/Ink.Util.Url.html">Ink.Util.Url</a></li>
            
                <li><a href="../classes/Ink.Util.Validator.html">Ink.Util.Validator</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
                <li><a href="../modules/Ink.Dom.Browser_1.html">Ink.Dom.Browser_1</a></li>
            
                <li><a href="../modules/Ink.Dom.Css_1.html">Ink.Dom.Css_1</a></li>
            
                <li><a href="../modules/Ink.Dom.Element_1.html">Ink.Dom.Element_1</a></li>
            
                <li><a href="../modules/Ink.Dom.Event_1.html">Ink.Dom.Event_1</a></li>
            
                <li><a href="../modules/Ink.Dom.FormSerialize.html">Ink.Dom.FormSerialize</a></li>
            
                <li><a href="../modules/Ink.Dom.Loaded_1.html">Ink.Dom.Loaded_1</a></li>
            
                <li><a href="../modules/Ink.Dom.Selector_1.html">Ink.Dom.Selector_1</a></li>
            
                <li><a href="../modules/Ink.Namespace.ClassModule_1.html">Ink.Namespace.ClassModule_1</a></li>
            
                <li><a href="../modules/Ink.Namespace.StaticModule_1.html">Ink.Namespace.StaticModule_1</a></li>
            
                <li><a href="../modules/Ink.Net.Ajax_1.html">Ink.Net.Ajax_1</a></li>
            
                <li><a href="../modules/Ink.Net.JsonP_1.html">Ink.Net.JsonP_1</a></li>
            
                <li><a href="../modules/Ink.UI.Animate_1.html">Ink.UI.Animate_1</a></li>
            
                <li><a href="../modules/Ink.UI.Carousel_1.html">Ink.UI.Carousel_1</a></li>
            
                <li><a href="../modules/Ink.UI.Close_1.html">Ink.UI.Close_1</a></li>
            
                <li><a href="../modules/Ink.UI.Common_1.html">Ink.UI.Common_1</a></li>
            
                <li><a href="../modules/Ink.UI.DatePicker_1.html">Ink.UI.DatePicker_1</a></li>
            
                <li><a href="../modules/Ink.UI.Dropdown_1.html">Ink.UI.Dropdown_1</a></li>
            
                <li><a href="../modules/Ink.UI.Droppable_1.html">Ink.UI.Droppable_1</a></li>
            
                <li><a href="../modules/Ink.UI.FormValidator_1.html">Ink.UI.FormValidator_1</a></li>
            
                <li><a href="../modules/Ink.UI.FormValidator_2.html">Ink.UI.FormValidator_2</a></li>
            
                <li><a href="../modules/Ink.UI.ImageQuery_1.html">Ink.UI.ImageQuery_1</a></li>
            
                <li><a href="../modules/Ink.UI.Modal_1.html">Ink.UI.Modal_1</a></li>
            
                <li><a href="../modules/Ink.UI.Pagination_1.html">Ink.UI.Pagination_1</a></li>
            
                <li><a href="../modules/Ink.UI.ProgressBar_1.html">Ink.UI.ProgressBar_1</a></li>
            
                <li><a href="../modules/Ink.UI.SmoothScroller_1.html">Ink.UI.SmoothScroller_1</a></li>
            
                <li><a href="../modules/Ink.UI.SortableList_1.html">Ink.UI.SortableList_1</a></li>
            
                <li><a href="../modules/Ink.UI.Spy_1.html">Ink.UI.Spy_1</a></li>
            
                <li><a href="../modules/Ink.UI.Stacker_1.html">Ink.UI.Stacker_1</a></li>
            
                <li><a href="../modules/Ink.UI.Sticky_1.html">Ink.UI.Sticky_1</a></li>
            
                <li><a href="../modules/Ink.UI.Swipe.html">Ink.UI.Swipe</a></li>
            
                <li><a href="../modules/Ink.UI.Table_1.html">Ink.UI.Table_1</a></li>
            
                <li><a href="../modules/Ink.UI.Tabs_1.html">Ink.UI.Tabs_1</a></li>
            
                <li><a href="../modules/Ink.UI.Toggle_1.html">Ink.UI.Toggle_1</a></li>
            
                <li><a href="../modules/Ink.UI.Tooltip_1.html">Ink.UI.Tooltip_1</a></li>
            
                <li><a href="../modules/Ink.UI.TreeView_1.html">Ink.UI.TreeView_1</a></li>
            
                <li><a href="../modules/Ink.Util.Array_1.html">Ink.Util.Array_1</a></li>
            
                <li><a href="../modules/Ink.Util.BinPack_1.html">Ink.Util.BinPack_1</a></li>
            
                <li><a href="../modules/Ink.Util.Cookie_1.html">Ink.Util.Cookie_1</a></li>
            
                <li><a href="../modules/Ink.Util.Date_1.html">Ink.Util.Date_1</a></li>
            
                <li><a href="../modules/Ink.Util.Dumper_1.html">Ink.Util.Dumper_1</a></li>
            
                <li><a href="../modules/Ink.Util.I18n_1.html">Ink.Util.I18n_1</a></li>
            
                <li><a href="../modules/Ink.Util.Json_1.html">Ink.Util.Json_1</a></li>
            
                <li><a href="../modules/Ink.Util.String_1.html">Ink.Util.String_1</a></li>
            
                <li><a href="../modules/Ink.Util.Url_1.html">Ink.Util.Url_1</a></li>
            
                <li><a href="../modules/Ink.Util.Validator_1.html">Ink.Util.Validator_1</a></li>
            
                <li><a href="../modules/Ink_1.html">Ink_1</a></li>
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: Ink/UI/Droppable/1/lib.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
/**
 * @module Ink.UI.Droppable_1
 * @author inkdev AT sapo.pt
 * @version 1
 */
Ink.createModule(&quot;Ink.UI.Droppable&quot;,&quot;1&quot;,[&quot;Ink.Dom.Element_1&quot;, &quot;Ink.Dom.Event_1&quot;, &quot;Ink.Dom.Css_1&quot;, &quot;Ink.UI.Common_1&quot;, &quot;Ink.Util.Array_1&quot;, &quot;Ink.Dom.Selector_1&quot;], function( InkElement, InkEvent, Css, Common, InkArray, Selector) {
    &#x27;use strict&#x27;;

    // Higher order functions
    var hAddClassName = function (element) {
        return function (className) {return Css.addClassName(element, className);};
    };
    var hRemoveClassName = function (element) {
        return function (className) {return Css.removeClassName(element, className);};
    };

    /**
     * @class Ink.UI.Droppable
     * @version 1
     * @static
     */
    var Droppable = {
        /**
         * Flag that determines if it&#x27;s in debug mode or not
         *
         * @property debug
         * @type {Boolean}
         * @private
         */
        debug: false,

        /**
         * Array with the data of each element (&#x60;{element: ..., data: ..., options: ...}&#x60;)
         * 
         * @property _droppables
         * @type {Array}
         * @private
         */
        _droppables: [],

        /**
         * Array of data for each draggable. (&#x60;{element: ..., data: ...}&#x60;)
         *
         * @property _draggables
         * @type {Array}
         * @private
         */
        _draggables: [],

        /**
         * Makes an element droppable and adds it to the stack of droppable elements.
         * Can consider it a constructor of droppable elements, but where no Droppable object is returned.
         * 
         * In the following arguments, any events/callbacks you may pass, can be either functions or strings. If the &#x27;move&#x27; or &#x27;copy&#x27; strings are passed, the draggable gets moved into this droppable. If &#x27;revert&#x27; is passed, an acceptable droppable is moved back to the element it came from.

         *
         * @method add
         * @param {String|DOMElement}       element     Target element
         * @param {Object}                  [options]   options object
         *     @param {String}      [options.hoverClass] Classname(s) applied when an acceptable draggable element is hovering the element
         *     @param {String}      [options.accept]    Selector for choosing draggables which can be dropped in this droppable.
         *     @param {Function}    [options.onHover]   callback called when an acceptable draggable element is hovering the droppable. Gets the draggable and the droppable element as parameters.
         *     @param {Function|String} [options.onDrop] callback called when an acceptable draggable element is dropped. Gets the draggable, the droppable and the event as parameters.
         *     @param {Function|String} [options.onDropOut] callback called when a droppable is dropped outside this droppable. Gets the draggable, the droppable and the event as parameters. (see above for string options).
         * @public
         *
         * @example
         *
         *       &lt;style type=&quot;text/css&quot;&gt;
         *           .hover {
         *               border: 1px solid red;
         *           }
         *           .left, .right {
         *               float: left; width: 50%;
         *               outline: 1px solid gray;
         *               min-height: 2em;
         *           }
         *       &lt;/style&gt;
         *        &lt;ul class=&quot;left&quot;&gt;
         *            &lt;li&gt;Draggable 1&lt;/li&gt;
         *            &lt;li&gt;Draggable 2&lt;/li&gt;
         *            &lt;li&gt;Draggable 3&lt;/li&gt;
         *        &lt;/ul&gt;
         *        &lt;ul class=&quot;right&quot;&gt;
         *        &lt;/ul&gt;
         *        &lt;script type=&quot;text/javascript&quot;&gt;
         *            Ink.requireModules([&#x27;Ink.UI.Draggable_1&#x27;, &#x27;Ink.UI.Droppable_1&#x27;], function (Draggable, Droppable) {
         *                new Draggable(&#x27;.left li:eq(0)&#x27;, {});
         *                new Draggable(&#x27;.left li:eq(1)&#x27;, {});
         *                new Draggable(&#x27;.left li:eq(2)&#x27;, {});
         *                Droppable.add(&#x27;.left&#x27;, {onDrop: &#x27;move&#x27;, onDropOut: &#x27;revert&#x27;});
         *                Droppable.add(&#x27;.right&#x27;, {onDrop: &#x27;move&#x27;, onDropOut: &#x27;revert&#x27;});
         *            })
         *        &lt;/script&gt;
         *
         */
        add: function(element, options) {
            element = Common.elOrSelector(element, &#x27;Droppable.add target element&#x27;);

            var opt = Ink.extendObj( {
                hoverClass:     options.hoverclass /* old name */ || false,
                accept:         false,
                onHover:        false,
                onDrop:         false,
                onDropOut:      false
            }, options || {}, InkElement.data(element));
            
            if (typeof opt.hoverClass === &#x27;string&#x27;) {
                opt.hoverClass = opt.hoverClass.split(/\s+/);
            }
            
            function cleanStyle(draggable) {
                draggable.style.position = &#x27;inherit&#x27;;
            }
            var that = this;
            var namedEventHandlers = {
                move: function (draggable, droppable/*, event*/) {
                    cleanStyle(draggable);
                    droppable.appendChild(draggable);
                },
                copy: function (draggable, droppable/*, event*/) {
                    cleanStyle(draggable);
                    droppable.appendChild(draggable.cloneNode);
                },
                revert: function (draggable/*, droppable, event*/) {
                    that._findDraggable(draggable).originalParent.appendChild(draggable);
                    cleanStyle(draggable);
                }
            };
            var name;

            if (typeof opt.onHover === &#x27;string&#x27;) {
                name = opt.onHover;
                opt.onHover = namedEventHandlers[name];
                if (opt.onHover === undefined) {
                    throw new Error(&#x27;Unknown hover event handler: &#x27; + name);
                }
            }
            if (typeof opt.onDrop === &#x27;string&#x27;) {
                name = opt.onDrop;
                opt.onDrop = namedEventHandlers[name];
                if (opt.onDrop === undefined) {
                    throw new Error(&#x27;Unknown drop event handler: &#x27; + name);
                }
            }
            if (typeof opt.onDropOut === &#x27;string&#x27;) {
                name = opt.onDropOut;
                opt.onDropOut = namedEventHandlers[name];
                if (opt.onDropOut === undefined) {
                    throw new Error(&#x27;Unknown dropOut event handler: &#x27; + name);
                }
            }

            var elementData = {
                element: element,
                data: {},
                options: opt
            };
            this._droppables.push(elementData);
            this._update(elementData);
        },
        
        /**
         * find droppable data about &#x60;element&#x60;. this data is added in &#x60;.add&#x60;
         *
         * @method _findData
         * @param {DOMElement} element  Needle
         * @return {object}             Droppable data of the element
         * @private
         */
        _findData: function (element) {
            var elms = this._droppables;
            for (var i = 0, len = elms.length; i &lt; len; i++) {
                if (elms[i].element === element) {
                    return elms[i];
                }
            }
        },
        /**
         * Find draggable data about &#x60;element&#x60;
         *
         * @method _findDraggable
         * @param {DOMElement} element  Needle
         * @return {Object}             Draggable data queried
         * @private
         */
        _findDraggable: function (element) {
            var elms = this._draggables;
            for (var i = 0, len = elms.length; i &lt; len; i++) {
                if (elms[i].element === element) {
                    return elms[i];
                }
            }
        },

        /**
         * Invoke every time a drag starts
         * 
         * @method updateAll
         * @private
         */
        updateAll: function() {
            InkArray.each(this._droppables, Droppable._update);
        },

        /**
         * Updates location and size of droppable element
         * 
         * @method update * @param {String|DOMElement} element - target element
         * @private
         */
        update: function(element) {
            this._update(this._findData(element));
        },

        _update: function(elementData) {
            var data = elementData.data;
            var element = elementData.element;
            data.left   = InkElement.offsetLeft(element);
            data.top    = InkElement.offsetTop( element);
            data.right  = data.left + InkElement.elementWidth( element);
            data.bottom = data.top  + InkElement.elementHeight(element);
        },

        /**
         * Removes an element from the droppable stack and removes the droppable behavior
         * 
         * @method remove
         * @param {String|DOMElement} elOrSelector  Droppable element to disable.
         * @return {Boolean} Whether the object was found and deleted
         * @public
         */
        remove: function(el) {
            el = Common.elOrSelector(el);
            var len = this._droppables.length;
            for (var i = 0; i &lt; len; i++) {
                if (this._droppables[i].element === el) {
                    this._droppables.splice(i, 1);
                    break;
                }
            }
            return len !== this._droppables.length;
        },

        /**
         * Method called by a draggable to execute an action on a droppable
         * 
         * @method action
         * @param {Object} coords    coordinates where the action happened
         * @param {String} type      type of action. drag or drop.
         * @param {Object} ev        Event object
         * @param {Object} draggable draggable element
         * @private
         */
        action: function(coords, type, ev, draggable) {
            // check all droppable elements
            InkArray.each(this._droppables, Ink.bind(function(elementData) {
                var data = elementData.data;
                var opt = elementData.options;
                var element = elementData.element;

                if (opt.accept &amp;&amp; !Selector.matches(opt.accept, [draggable]).length) {
                    return;
                }

                if (type === &#x27;drag&#x27; &amp;&amp; !this._findDraggable(draggable)) {
                    this._draggables.push({
                        element: draggable,
                        originalParent: draggable.parentNode
                    });
                }

                // check if our draggable is over our droppable
                if (coords.x &gt;= data.left &amp;&amp; coords.x &lt;= data.right &amp;&amp;
                        coords.y &gt;= data.top &amp;&amp; coords.y &lt;= data.bottom) {
                    // INSIDE
                    if (type === &#x27;drag&#x27;) {
                        if (opt.hoverClass) {
                            InkArray.each(opt.hoverClass,
                                hAddClassName(element));
                        }
                        if (opt.onHover) {
                            opt.onHover(draggable, element);
                        }
                    } else if (type === &#x27;drop&#x27;) {
                        if (opt.hoverClass) {
                            InkArray.each(opt.hoverClass,
                                hRemoveClassName(element));
                        }
                        if (opt.onDrop) {
                            opt.onDrop(draggable, element, ev);
                        }
                    }
                } else {
                    // OUTSIDE

                    if (type === &#x27;drag&#x27; &amp;&amp; opt.hoverClass) {
                        InkArray.each(opt.hoverClass, hRemoveClassName(element));
                    } else if (type === &#x27;drop&#x27;) {
                        if(opt.onDropOut){
                            opt.onDropOut(draggable, element, ev);
                        }
                    }
                }
            }, this));
        }
    };

    return Droppable;
});

    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
