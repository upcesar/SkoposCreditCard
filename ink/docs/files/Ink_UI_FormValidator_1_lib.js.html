<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Ink/UI/FormValidator/1/lib.js - Ink.js</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="../yuidoclogo.png" title="Ink.js"></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: latest</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="../classes/Ink.html">Ink</a></li>
            
                <li><a href="../classes/Ink.Dom.Browser.html">Ink.Dom.Browser</a></li>
            
                <li><a href="../classes/Ink.Dom.Css.html">Ink.Dom.Css</a></li>
            
                <li><a href="../classes/Ink.Dom.Element.html">Ink.Dom.Element</a></li>
            
                <li><a href="../classes/Ink.Dom.Event.html">Ink.Dom.Event</a></li>
            
                <li><a href="../classes/Ink.Dom.FormSerialize.html">Ink.Dom.FormSerialize</a></li>
            
                <li><a href="../classes/Ink.Dom.Loaded.html">Ink.Dom.Loaded</a></li>
            
                <li><a href="../classes/Ink.Dom.Selector.html">Ink.Dom.Selector</a></li>
            
                <li><a href="../classes/Ink.Namespace.ClassModule.html">Ink.Namespace.ClassModule</a></li>
            
                <li><a href="../classes/Ink.Namespace.StaticModule.html">Ink.Namespace.StaticModule</a></li>
            
                <li><a href="../classes/Ink.Net.Ajax.html">Ink.Net.Ajax</a></li>
            
                <li><a href="../classes/Ink.Net.JsonP.html">Ink.Net.JsonP</a></li>
            
                <li><a href="../classes/Ink.UI.Animate_1.html">Ink.UI.Animate_1</a></li>
            
                <li><a href="../classes/Ink.UI.Carousel_1.html">Ink.UI.Carousel_1</a></li>
            
                <li><a href="../classes/Ink.UI.Close.html">Ink.UI.Close</a></li>
            
                <li><a href="../classes/Ink.UI.Common.html">Ink.UI.Common</a></li>
            
                <li><a href="../classes/Ink.UI.DatePicker.html">Ink.UI.DatePicker</a></li>
            
                <li><a href="../classes/Ink.UI.Draggable.html">Ink.UI.Draggable</a></li>
            
                <li><a href="../classes/Ink.UI.Dropdown.html">Ink.UI.Dropdown</a></li>
            
                <li><a href="../classes/Ink.UI.Droppable.html">Ink.UI.Droppable</a></li>
            
                <li><a href="../classes/Ink.UI.FormValidator.html">Ink.UI.FormValidator</a></li>
            
                <li><a href="../classes/Ink.UI.FormValidator_2.html">Ink.UI.FormValidator_2</a></li>
            
                <li><a href="../classes/Ink.UI.ImageQuery.html">Ink.UI.ImageQuery</a></li>
            
                <li><a href="../classes/Ink.UI.Modal.html">Ink.UI.Modal</a></li>
            
                <li><a href="../classes/Ink.UI.Pagination.html">Ink.UI.Pagination</a></li>
            
                <li><a href="../classes/Ink.UI.ProgressBar.html">Ink.UI.ProgressBar</a></li>
            
                <li><a href="../classes/Ink.UI.SmoothScroller.html">Ink.UI.SmoothScroller</a></li>
            
                <li><a href="../classes/Ink.UI.SortableList.html">Ink.UI.SortableList</a></li>
            
                <li><a href="../classes/Ink.UI.Spy.html">Ink.UI.Spy</a></li>
            
                <li><a href="../classes/Ink.UI.Stacker_1.html">Ink.UI.Stacker_1</a></li>
            
                <li><a href="../classes/Ink.UI.Sticky.html">Ink.UI.Sticky</a></li>
            
                <li><a href="../classes/Ink.UI.Swipe.html">Ink.UI.Swipe</a></li>
            
                <li><a href="../classes/Ink.UI.Table.html">Ink.UI.Table</a></li>
            
                <li><a href="../classes/Ink.UI.Tabs.html">Ink.UI.Tabs</a></li>
            
                <li><a href="../classes/Ink.UI.TagField.html">Ink.UI.TagField</a></li>
            
                <li><a href="../classes/Ink.UI.Toggle.html">Ink.UI.Toggle</a></li>
            
                <li><a href="../classes/Ink.UI.Tooltip.html">Ink.UI.Tooltip</a></li>
            
                <li><a href="../classes/Ink.UI.TreeView.html">Ink.UI.TreeView</a></li>
            
                <li><a href="../classes/Ink.Util.Array.html">Ink.Util.Array</a></li>
            
                <li><a href="../classes/Ink.Util.BinPack.html">Ink.Util.BinPack</a></li>
            
                <li><a href="../classes/Ink.Util.Cookie.html">Ink.Util.Cookie</a></li>
            
                <li><a href="../classes/Ink.Util.Date.html">Ink.Util.Date</a></li>
            
                <li><a href="../classes/Ink.Util.Dumper.html">Ink.Util.Dumper</a></li>
            
                <li><a href="../classes/Ink.Util.I18n.html">Ink.Util.I18n</a></li>
            
                <li><a href="../classes/Ink.Util.Json.html">Ink.Util.Json</a></li>
            
                <li><a href="../classes/Ink.Util.String.html">Ink.Util.String</a></li>
            
                <li><a href="../classes/Ink.Util.Url.html">Ink.Util.Url</a></li>
            
                <li><a href="../classes/Ink.Util.Validator.html">Ink.Util.Validator</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
                <li><a href="../modules/Ink.Dom.Browser_1.html">Ink.Dom.Browser_1</a></li>
            
                <li><a href="../modules/Ink.Dom.Css_1.html">Ink.Dom.Css_1</a></li>
            
                <li><a href="../modules/Ink.Dom.Element_1.html">Ink.Dom.Element_1</a></li>
            
                <li><a href="../modules/Ink.Dom.Event_1.html">Ink.Dom.Event_1</a></li>
            
                <li><a href="../modules/Ink.Dom.FormSerialize.html">Ink.Dom.FormSerialize</a></li>
            
                <li><a href="../modules/Ink.Dom.Loaded_1.html">Ink.Dom.Loaded_1</a></li>
            
                <li><a href="../modules/Ink.Dom.Selector_1.html">Ink.Dom.Selector_1</a></li>
            
                <li><a href="../modules/Ink.Namespace.ClassModule_1.html">Ink.Namespace.ClassModule_1</a></li>
            
                <li><a href="../modules/Ink.Namespace.StaticModule_1.html">Ink.Namespace.StaticModule_1</a></li>
            
                <li><a href="../modules/Ink.Net.Ajax_1.html">Ink.Net.Ajax_1</a></li>
            
                <li><a href="../modules/Ink.Net.JsonP_1.html">Ink.Net.JsonP_1</a></li>
            
                <li><a href="../modules/Ink.UI.Animate_1.html">Ink.UI.Animate_1</a></li>
            
                <li><a href="../modules/Ink.UI.Carousel_1.html">Ink.UI.Carousel_1</a></li>
            
                <li><a href="../modules/Ink.UI.Close_1.html">Ink.UI.Close_1</a></li>
            
                <li><a href="../modules/Ink.UI.Common_1.html">Ink.UI.Common_1</a></li>
            
                <li><a href="../modules/Ink.UI.DatePicker_1.html">Ink.UI.DatePicker_1</a></li>
            
                <li><a href="../modules/Ink.UI.Dropdown_1.html">Ink.UI.Dropdown_1</a></li>
            
                <li><a href="../modules/Ink.UI.Droppable_1.html">Ink.UI.Droppable_1</a></li>
            
                <li><a href="../modules/Ink.UI.FormValidator_1.html">Ink.UI.FormValidator_1</a></li>
            
                <li><a href="../modules/Ink.UI.FormValidator_2.html">Ink.UI.FormValidator_2</a></li>
            
                <li><a href="../modules/Ink.UI.ImageQuery_1.html">Ink.UI.ImageQuery_1</a></li>
            
                <li><a href="../modules/Ink.UI.Modal_1.html">Ink.UI.Modal_1</a></li>
            
                <li><a href="../modules/Ink.UI.Pagination_1.html">Ink.UI.Pagination_1</a></li>
            
                <li><a href="../modules/Ink.UI.ProgressBar_1.html">Ink.UI.ProgressBar_1</a></li>
            
                <li><a href="../modules/Ink.UI.SmoothScroller_1.html">Ink.UI.SmoothScroller_1</a></li>
            
                <li><a href="../modules/Ink.UI.SortableList_1.html">Ink.UI.SortableList_1</a></li>
            
                <li><a href="../modules/Ink.UI.Spy_1.html">Ink.UI.Spy_1</a></li>
            
                <li><a href="../modules/Ink.UI.Stacker_1.html">Ink.UI.Stacker_1</a></li>
            
                <li><a href="../modules/Ink.UI.Sticky_1.html">Ink.UI.Sticky_1</a></li>
            
                <li><a href="../modules/Ink.UI.Swipe.html">Ink.UI.Swipe</a></li>
            
                <li><a href="../modules/Ink.UI.Table_1.html">Ink.UI.Table_1</a></li>
            
                <li><a href="../modules/Ink.UI.Tabs_1.html">Ink.UI.Tabs_1</a></li>
            
                <li><a href="../modules/Ink.UI.Toggle_1.html">Ink.UI.Toggle_1</a></li>
            
                <li><a href="../modules/Ink.UI.Tooltip_1.html">Ink.UI.Tooltip_1</a></li>
            
                <li><a href="../modules/Ink.UI.TreeView_1.html">Ink.UI.TreeView_1</a></li>
            
                <li><a href="../modules/Ink.Util.Array_1.html">Ink.Util.Array_1</a></li>
            
                <li><a href="../modules/Ink.Util.BinPack_1.html">Ink.Util.BinPack_1</a></li>
            
                <li><a href="../modules/Ink.Util.Cookie_1.html">Ink.Util.Cookie_1</a></li>
            
                <li><a href="../modules/Ink.Util.Date_1.html">Ink.Util.Date_1</a></li>
            
                <li><a href="../modules/Ink.Util.Dumper_1.html">Ink.Util.Dumper_1</a></li>
            
                <li><a href="../modules/Ink.Util.I18n_1.html">Ink.Util.I18n_1</a></li>
            
                <li><a href="../modules/Ink.Util.Json_1.html">Ink.Util.Json_1</a></li>
            
                <li><a href="../modules/Ink.Util.String_1.html">Ink.Util.String_1</a></li>
            
                <li><a href="../modules/Ink.Util.Url_1.html">Ink.Util.Url_1</a></li>
            
                <li><a href="../modules/Ink.Util.Validator_1.html">Ink.Util.Validator_1</a></li>
            
                <li><a href="../modules/Ink_1.html">Ink_1</a></li>
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: Ink/UI/FormValidator/1/lib.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
/**
 * @module Ink.UI.FormValidator_1
 * @author inkdev AT sapo.pt
 * @version 1
 **/
Ink.createModule(&#x27;Ink.UI.FormValidator&#x27;, &#x27;1&#x27;, [&#x27;Ink.Dom.Element_1&#x27;, &#x27;Ink.Dom.Css_1&#x27;,&#x27;Ink.Util.Validator_1&#x27;,&#x27;Ink.Dom.Selector_1&#x27;], function( InkElement, Css, InkValidator , Selector) {
    &#x27;use strict&#x27;;

    function elementsWithSameName(elm) {
        if (!elm.name) { return []; }
        if (!elm.form) {
            return Selector.select(&#x27;name=&quot;&#x27; + elm.name + &#x27;&quot;&#x27;);
        }
        var ret = elm.form[elm.name];
        if(typeof(ret.length) === &#x27;undefined&#x27;) {
            ret = [ret];
        }
        return ret;
    }
    /**
     * @class Ink.UI.FormValidator
     * @version 1
     */
    var FormValidator = {

        /**
         * Specifies the version of the component
         *
         * @property version
         * @type {String}
         * @readOnly
         * @public
         */
        version: &#x27;1&#x27;,

        /**
         * Available flags to use in the validation process.
         * The keys are the &#x27;rules&#x27;, and their values are objects with the key &#x27;msg&#x27;, determining
         * what is the error message.
         *
         * @property _flagMap
         * @type {Object}
         * @readOnly
         * @private
         */
        _flagMap: {
            //&#x27;ink-fv-required&#x27;: {msg: &#x27;Campo obrigat&amp;oacute;rio&#x27;},
            &#x27;ink-fv-required&#x27;: {msg: &#x27;Required field&#x27;},
            //&#x27;ink-fv-email&#x27;: {msg: &#x27;E-mail inv&amp;aacute;lido&#x27;},
            &#x27;ink-fv-email&#x27;: {msg: &#x27;Invalid e-mail address&#x27;},
            //&#x27;ink-fv-url&#x27;: {msg: &#x27;URL inv&amp;aacute;lido&#x27;},
            &#x27;ink-fv-url&#x27;: {msg: &#x27;Invalid URL&#x27;},
            //&#x27;ink-fv-number&#x27;: {msg: &#x27;N&amp;uacute;mero inv&amp;aacute;lido&#x27;},
            &#x27;ink-fv-number&#x27;: {msg: &#x27;Invalid number&#x27;},
            //&#x27;ink-fv-phone_pt&#x27;: {msg: &#x27;N&amp;uacute;mero de telefone inv&amp;aacute;lido&#x27;},
            &#x27;ink-fv-phone_pt&#x27;: {msg: &#x27;Invalid phone number&#x27;},
            //&#x27;ink-fv-phone_cv&#x27;: {msg: &#x27;N&amp;uacute;mero de telefone inv&amp;aacute;lido&#x27;},
            &#x27;ink-fv-phone_cv&#x27;: {msg: &#x27;Invalid phone number&#x27;},
            //&#x27;ink-fv-phone_mz&#x27;: {msg: &#x27;N&amp;uacute;mero de telefone inv&amp;aacute;lido&#x27;},
            &#x27;ink-fv-phone_mz&#x27;: {msg: &#x27;Invalid phone number&#x27;},
            //&#x27;ink-fv-phone_ao&#x27;: {msg: &#x27;N&amp;uacute;mero de telefone inv&amp;aacute;lido&#x27;},
            &#x27;ink-fv-phone_ao&#x27;: {msg: &#x27;Invalid phone number&#x27;},
            //&#x27;ink-fv-date&#x27;: {msg: &#x27;Data inv&amp;aacute;lida&#x27;},
            &#x27;ink-fv-date&#x27;: {msg: &#x27;Invalid date&#x27;},
            //&#x27;ink-fv-confirm&#x27;: {msg: &#x27;Confirma&amp;ccedil;&amp;atilde;o inv&amp;aacute;lida&#x27;},
            &#x27;ink-fv-confirm&#x27;: {msg: &#x27;Confirmation does not match&#x27;},
            &#x27;ink-fv-custom&#x27;: {msg: &#x27;&#x27;}
        },

        /**
         * This property holds all form elements for later validation
         *
         * @property elements
         * @type {Object}
         * @public
         */
        elements: {},

        /**
         * This property holds the objects needed to cross-check for the &#x27;confirm&#x27; rule
         *
         * @property confirmElms
         * @type {Object}
         * @public
         */
        confirmElms: {},

        /**
         * This property holds the previous elements in the confirmElms property, but with a
         * true/false specifying if it has the class ink-fv-confirm.
         *
         * @property hasConfirm
         * @type {Object}
         */
        hasConfirm: {},

        /**
         * Defined class name to use in error messages label
         *
         * @property _errorClassName
         * @type {String}
         * @readOnly
         * @private
         */
        _errorClassName: &#x27;tip error&#x27;,

        /**
         * @property _errorValidationClassName
         * @type {String}
         * @readOnly
         * @private
         */
        _errorValidationClassName: &#x27;validaton&#x27;,

        /**
         * @property _errorTypeWarningClassName
         * @type {String}
         * @readOnly
         * @private
         */
        _errorTypeWarningClassName: &#x27;warning&#x27;,

        /**
         * @property _errorTypeErrorClassName
         * @type {String}
         * @readOnly
         * @private
         */
        _errorTypeErrorClassName: &#x27;error&#x27;,

        /**
         * Check if a form is valid or not
         * 
         * @method validate
         * @param {DOMElement|String} elm DOM form element or form id
         * @param {Object} options Options for
         *      @param {Function} [options.onSuccess] function to run when form is valid
         *      @param {Function} [options.onError] function to run when form is not valid
         *      @param {Array} [options.customFlag] custom flags to use to validate form fields
         * @public
         * @return {Boolean} Whether the form is deemed valid or not.
         *
         * @example
         *
         * ## What markup do I need?
         *
         * Besides the markup structure you can see in
         * &lt;a href=&quot;http://ink.sapo.pt/forms#building&quot;&gt;&lt;/a&gt;, you need to add
         * the &#x60;ink-fv-*&#x60; classes to your inputs, which correspond to validation
         * rules in this component. Available classes are:
         *
         * - &#x60;ink-fv-required&#x60; : Required field
         * - &#x60;ink-fv-email&#x60;    : Valid e-mail
         * - &#x60;ink-fv-url&#x60;      : Valid URL address
         * - &#x60;ink-fv-number&#x60;   : Valid number
         * - &#x60;ink-fv-phone_pt&#x60;, &#x60;ink-fv-phone_cv&#x60;, &#x60;ink-fv-phone_mz&#x60;, &#x60;ink-fv-phone_ao&#x60; : Valid telephone number in Portugal, Cape Verde, Mozambique or Angola.
         * - &#x60;ink-fv-date&#x60;     : Valid date
         * - &#x60;ink-fv-confirm&#x60;  : Make the user type the same thing twice. Common rule for confirming passwords.
         * - &#x60;ink-fv-custom&#x60;   : Custom rule (see below example &quot;Custom rule&quot;)
         * 
         *           E-mail field: &lt;input class=&quot;ink-fv-required ink-fv-email&quot;&gt;&lt;br&gt;
         *           Phone number field: &lt;input class=&quot;ink-fv-number ink-fv-required&quot;&gt;&lt;br&gt;
         *           Website field (optional): &lt;input class=&quot;ink-fv-url&quot;&gt;
         * 
         * ## Simple usage
         *
         * So you have a form and would like to validate it? This example shows
         * how to validate a form and stop it from being submitted when invalid.
         * To use this, add the several ink-fv-* classes to your input elements.
         *
         * The validate() function will also add &quot;invalid&quot; classes to each of
         * your elements so the user gets a color feedback and an error message
         * below each element (control-group, really).
         *
         *         var myForm = Ink.i(&#x27;my-form&#x27;);
         *         InkEvent.observe(myForm, &#x27;submit&#x27;, function (ev) {
         *             var formIsValid = FormValidator.validate(myForm);
         *             if (!formIsValid) {
         *                 InkEvent.stop(ev);  // Cancel submission of form.
         *             }
         *         });
         *
         * @example
         *
         * ## Custom rule.
         *
         * The following code validates using a custom rule named &#x60;minthree&#x60;,
         * which fails if the input string has less than three characters.
         * To do this, you must add the &#x60;ink-fv-custom&#x60; and &#x60;minthree&#x60; classes
         * to the input elements you want to validate, and pass the &#x60;customFlag&#x60;
         * option to this function, like so:
         *
         *         var isValid = FormValidator.validate(myForm, {
         *             customFlag: [
         *                 {
         *                     flag: &#x27;minthree&#x27;,  // The name of this rule (add this class to your &lt;input&gt;s
         *                     msg: &#x27;Please input at least three characters&#x27;,  // Error message when rule fails
         *                     callback: function (el) {
         *                         return el.value.length &gt;= 3  // Return true when okay, false when not
         *                     }
         *                 }
         *             ]
         *         });
         */
        validate: function(elm, options) {
            this._free();

            options = Ink.extendObj({
                onSuccess: false,
                onError: false,
                customFlag: false,
                confirmGroup: []
            }, options || {});

            if(typeof(elm) === &#x27;string&#x27;) {
                elm = document.getElementById(elm);
            }
            if(elm === null){
                return false;
            }
            this.element = elm;

            if(typeof(this.element.id) === &#x27;undefined&#x27; || this.element.id === null || this.element.id === &#x27;&#x27;) {
                // generate a random ID
                // TODO ugly and potentially problematic, and you know Murphy&#x27;s law.
                this.element.id = &#x27;ink-fv_randomid_&#x27;+(Math.round(Math.random() * 99999));
            }

            this.custom = options.customFlag;

            this.confirmGroup = options.confirmGroup;

            var fail = this._validateElements();

            if(fail.length &gt; 0) {
                if(options.onError) {
                    options.onError(fail);
                } else {
                    this._showError(elm, fail);
                }
                return false;
            } else {
                if(!options.onError) {
                    this._clearError(elm);
                }
                this._clearCache();
                if(options.onSuccess) {
                    options.onSuccess();
                }
                return true;
            }

        },

        /**
         * Reset previously generated validation errors
         * 
         * @method reset
         * @public
         */
        reset: function()
        {
            this._clearError();
            this._clearCache();
        },

        /**
         * Cleans the object
         * 
         * @method _free
         * @private
         */
        _free: function()
        {
            this.element = null;
            //this.elements = [];
            this.custom = false;
            this.confirmGroup = false;
        },

        /**
         * Cleans the properties responsible for caching
         * 
         * @method _clearCache
         * @private
         */
        _clearCache: function()
        {
            this.element = null;
            this.elements = [];
            this.custom = false;
            this.confirmGroup = false;
        },

        /**
         * Gets the form elements and stores them in the caching properties
         * 
         * @method _getElements
         * @private
         */
        _getElements: function()
        {
            //this.elements = [];
            // if(typeof(this.elements[this.element.id]) !== &#x27;undefined&#x27;) {
            //     return;
            // }

            var elements = this.elements[this.element.id] = [];
            this.confirmElms[this.element.id] = [];
            //console.log(this.element);
            //console.log(this.element.elements);
            var formElms = Selector.select(&#x27;:input&#x27;, this.element);
            var curElm = false;
            for(var i=0, totalElm = formElms.length; i &lt; totalElm; i++) {
                curElm = formElms[i];
                var type = (curElm.getAttribute(&#x27;type&#x27;) + &#x27;&#x27;).toLowerCase();

                if (type === &#x27;radio&#x27; || type === &#x27;checkbox&#x27;) {
                    if(elements.length === 0 ||
                            (
                             curElm.getAttribute(&#x27;type&#x27;) !== elements[elements.length - 1].getAttribute(&#x27;type&#x27;) &amp;&amp;
                            curElm.getAttribute(&#x27;name&#x27;) !== elements[elements.length - 1].getAttribute(&#x27;name&#x27;)
                            )) {
                        for(var flag in this._flagMap) {
                            if(Css.hasClassName(curElm, flag)) {
                                elements.push(curElm);
                                break;
                            }
                        }
                    }
                } else {
                    for(var flag2 in this._flagMap) {
                        if(Css.hasClassName(curElm, flag2) &amp;&amp; flag2 !== &#x27;ink-fv-confirm&#x27;) {
                            /*if(flag2 == &#x27;ink-fv-confirm&#x27;) {
                                this.confirmElms[this.element.id].push(curElm);
                                this.hasConfirm[this.element.id] = true;
                            }*/
                            elements.push(curElm);
                            break;
                        }
                    }

                    if(Css.hasClassName(curElm, &#x27;ink-fv-confirm&#x27;)) {
                        this.confirmElms[this.element.id].push(curElm);
                        this.hasConfirm[this.element.id] = true;
                    }

                }
            }
        },

        /**
         * Runs the validation for each element
         * 
         * @method _validateElements
         * @private
         */
        _validateElements: function() {
            var oGroups;
            this._getElements();
            if(this.hasConfirm[this.element.id] === true) {
                oGroups = this._makeConfirmGroups();
            }

            var errors = [];

            var curElm = false;
            var customErrors = false;
            var inArray;
            for(var i=0, totalElm = this.elements[this.element.id].length; i &lt; totalElm; i++) {
                inArray = false;
                curElm = this.elements[this.element.id][i];

                if(!curElm.disabled) {
                    for(var flag in this._flagMap) {
                        if(Css.hasClassName(curElm, flag)) {
                            if(flag !== &#x27;ink-fv-custom&#x27; &amp;&amp; flag !== &#x27;ink-fv-confirm&#x27;) {
                                if(!this._isValid(curElm, flag)) {
                                    if(!inArray) {
                                        errors.push({elm: curElm, errors:[flag]});
                                        inArray = true;
                                    } else {
                                        errors[(errors.length - 1)].errors.push(flag);
                                    }
                                }
                            } else if(flag !== &#x27;ink-fv-confirm&#x27;){
                                customErrors = this._isCustomValid(curElm);
                                if(customErrors.length &gt; 0) {
                                    errors.push({elm: curElm, errors:[flag], custom: customErrors});
                                }
                            } else if(flag === &#x27;ink-fv-confirm&#x27;){
                                continue;
                            }
                        }
                    }
                }
            }
            errors = this._validateConfirmGroups(oGroups, errors);
            //console.log(InkDumper.returnDump(errors));
            return errors;
        },

        /**
         * Runs the &#x27;confirm&#x27; validation for each group of elements
         * 
         * @method _validateConfirmGroups
         * @param {Array} oGroups Array/Object that contains the group of confirm objects
         * @param {Array} errors Array that will store the errors
         * @private
         * @return {Array} Array of errors that was passed as 2nd parameter (either changed, or not, depending if errors were found).
         */
        _validateConfirmGroups: function(oGroups, errors) {
            //console.log(oGroups);
            var curGroup = false;
            for(var i in oGroups) if (oGroups.hasOwnProperty(i)) {
                curGroup = oGroups[i];
                if(curGroup.length === 2) {
                    if(curGroup[0].value !== curGroup[1].value) {
                        errors.push({elm:curGroup[1], errors:[&#x27;ink-fv-confirm&#x27;]});
                    }
                }
            }
            return errors;
        },

        /**
         * Creates the groups of &#x27;confirm&#x27; objects
         * 
         * @method _makeConfirmGroups
         * @private
         * @return {Array|Boolean} Returns the array of confirm elements or false on error.
         */
        _makeConfirmGroups: function()
        {
            var oGroups;
            if(this.confirmGroup &amp;&amp; this.confirmGroup.length &gt; 0) {
                oGroups = {};
                var curElm = false;
                var curGroup = false;
                //this.confirmElms[this.element.id];
                for(var i=0, total=this.confirmElms[this.element.id].length; i &lt; total; i++) {
                    curElm = this.confirmElms[this.element.id][i];
                    for(var j=0, totalG=this.confirmGroup.length; j &lt; totalG; j++) {
                        curGroup =  this.confirmGroup[j];
                        if(Css.hasClassName(curElm, curGroup)) {
                            if(typeof(oGroups[curGroup]) === &#x27;undefined&#x27;) {
                                oGroups[curGroup] = [curElm];
                            } else {
                                oGroups[curGroup].push(curElm);
                            }
                        }
                    }
                }
                return oGroups;
            } else {
                if(this.confirmElms[this.element.id].length === 2) {
                    oGroups = {
                        &quot;ink-fv-confirm&quot;: [
                            this.confirmElms[this.element.id][0],
                            this.confirmElms[this.element.id][1]
                        ]
                    };
                }
                return oGroups;
            }
            return false;
        },

        /**
         * Validates an element with a custom validation
         * 
         * @method _isCustomValid
         * @param {DOMElemenmt} elm Element to be validated
         * @private
         * @return {Array} Array of errors. If no errors are found, results in an empty array.
         */
        _isCustomValid: function(elm)
        {
            var customErrors = [];
            var curFlag = false;
            for(var i=0, tCustom = this.custom.length; i &lt; tCustom; i++) {
                curFlag = this.custom[i];
                if(Css.hasClassName(elm, curFlag.flag)) {
                    if(!curFlag.callback(elm, curFlag.msg)) {
                        customErrors.push({flag: curFlag.flag, msg: curFlag.msg});
                    }
                }
            }
            return customErrors;
        },

        /**
         * Runs the normal validation functions for a specific element
         * 
         * @method _isValid
         * @param {DOMElement} elm DOMElement that will be validated
         * @param {String} fieldType Rule to be validated. This must be one of the keys present in the _flagMap property.
         * @private
         * @return {Boolean} The result of the validation.
         */
        _isValid: function(elm, fieldType) {
            var nodeName = elm.nodeName.toLowerCase();
            var inputType = (elm.getAttribute(&#x27;type&#x27;) || &#x27;&#x27;).toLowerCase();
            var value = this._trim(elm.value);

            // When we&#x27;re analyzing emails, telephones, etc, and the field is
            // empty, we check if it is required. If not required, it&#x27;s valid.
            if (fieldType !== &#x27;ink-fv-required&#x27; &amp;&amp;
                    inputType !== &#x27;checkbox&#x27; &amp;&amp; inputType !== &#x27;radio&#x27; &amp;&amp;
                    value === &#x27;&#x27;) {
                return !Css.hasClassName(elm, &#x27;ink-fv-required&#x27;);
            }

            switch(fieldType) {
                case &#x27;ink-fv-required&#x27;:
                    if(nodeName === &#x27;select&#x27;) {
                        if(elm.selectedIndex &gt; 0) {
                            return true;
                        } else {
                            return false;
                        }
                    }
                    if(inputType !== &#x27;checkbox&#x27; &amp;&amp; inputType !== &#x27;radio&#x27; &amp;&amp;
                            value !== &#x27;&#x27;) {
                        return true;  // A input type=text,email,etc.
                    } else if(inputType === &#x27;checkbox&#x27; || inputType === &#x27;radio&#x27;) {
                        var aFormRadios = elementsWithSameName(elm);
                        var isChecked = false;
                        // check if any input of the radio is checked
                        for(var i=0, totalRadio = aFormRadios.length; i &lt; totalRadio; i++) {
                            if(aFormRadios[i].checked === true) {
                                isChecked = true;
                                break;
                            }
                        }
                        return isChecked;
                    }
                    return false;

                case &#x27;ink-fv-email&#x27;:
                    return InkValidator.mail(elm.value);

                case &#x27;ink-fv-url&#x27;:
                    return InkValidator.url(elm.value);

                case &#x27;ink-fv-number&#x27;:
                    return !isNaN(Number(elm.value)) &amp;&amp; isFinite(Number(elm.value));

                case &#x27;ink-fv-phone_pt&#x27;:
                    return InkValidator.isPTPhone(elm.value);

                case &#x27;ink-fv-phone_cv&#x27;:
                    return InkValidator.isCVPhone(elm.value);

                case &#x27;ink-fv-phone_ao&#x27;:
                    return InkValidator.isAOPhone(elm.value);

                case &#x27;ink-fv-phone_mz&#x27;:
                    return InkValidator.isMZPhone(elm.value);

                case &#x27;ink-fv-date&#x27;:
                    var Element = Ink.getModule(&#x27;Ink.Dom.Element&#x27;,1);
                    var dataset = Element.data( elm );
                    var validFormat = &#x27;yyyy-mm-dd&#x27;;

                    if( Css.hasClassName(elm, &#x27;ink-datepicker&#x27;) &amp;&amp; (&#x27;format&#x27; in dataset) ){
                        validFormat = dataset.format;
                    } else if( (&#x27;validFormat&#x27; in dataset) ){
                        validFormat = dataset.validFormat;
                    }

                    if( !(validFormat in InkValidator._dateParsers ) ){
                        var validValues = [];
                        for( var val in InkValidator._dateParsers ){
                            if (InkValidator._dateParsers.hasOwnProperty(val)) {
                                validValues.push(val);
                            }
                        }
                        throw new Error(
                            &#x27;The attribute data-valid-format must be one of &#x27; +
                            &#x27;the following values: &#x27; + validValues.join(&#x27;, &#x27;));
                    }
                    
                    return InkValidator.isDate( validFormat, elm.value );
                case &#x27;ink-fv-custom&#x27;:
                    break;
            }

            return false;
        },

        /**
         * Makes the necessary changes to the markup to show the errors of a given element
         * 
         * @method _showError
         * @param {DOMElement} formElm The form element to be changed to show the errors
         * @param {Array} aFail An array with the errors found.
         * @private
         */
        _showError: function(formElm, aFail) {
            this._clearError(formElm);

            //ink-warning-field

            //console.log(aFail);
            var curElm = false;
            for(var i=0, tFail = aFail.length; i &lt; tFail; i++) {
                curElm = aFail[i].elm;
                if (curElm) {
                    this._showAnErrorOnElement(curElm, aFail[i]);
                }
            }
        },

        _showAnErrorOnElement: function (curElm, error) {
            /* jshint noempty:false */

            var controlGroupElm = InkElement.findUpwardsByClass(
                    curElm, &#x27;control-group&#x27;);
            var controlElm = InkElement.findUpwardsByClass(
                    curElm, &#x27;control&#x27;);

            var errorClasses = [
                this._errorClassName,
                this._errorTypeClassName].join(&#x27; &#x27;);

            var errorMsg = InkElement.create(&#x27;p&#x27;, {
                className: errorClasses
            });

            if(error.errors[0] !== &#x27;ink-fv-custom&#x27;) {
                errorMsg.innerHTML = this._flagMap[error.errors[0]].msg;
            } else {
                errorMsg.innerHTML = error.custom[0].msg;
            }

            var target = (controlElm || controlGroupElm);
            if (target) {
                target.appendChild(errorMsg);
            } else {
                InkElement.insertAfter(errorMsg, curElm);
            }

            if (controlElm) {
                if(error.errors[0] === &#x27;ink-fv-required&#x27;) {
                    Css.addClassName(controlGroupElm, &#x27;validation error&#x27;);
                } else {
                    Css.addClassName(controlGroupElm, &#x27;validation warning&#x27;);
                }
            }
        },

        /**
         * Clears the error of a given element. Normally executed before any validation, for all elements, as a reset.
         * 
         * @method _clearErrors
         * @param {DOMElement} formElm Form element to be cleared.
         * @private
         */
        _clearError: function(formElm) {
            //return;
            var aErrorLabel = formElm.getElementsByTagName(&#x27;p&#x27;);

            var curElm;
            var control;

            for(var i = (aErrorLabel.length - 1); i &gt;= 0; i--) {
                curElm = aErrorLabel[i];
                if(Css.hasClassName(curElm, this._errorClassName)) {
                    control = InkElement.findUpwardsBySelector(curElm, &#x27;.control-group&#x27;);
                    if (control) {
                        Css.removeClassName(control, [&#x27;validation&#x27;, &#x27;error&#x27;, &#x27;warning&#x27;]);
                    }

                    if(Css.hasClassName(curElm, this._errorClassName, true /*both*/)) {
                        InkElement.remove(curElm);
                    }
                }
            }

            var aErrorLabel2 = formElm.getElementsByTagName(&#x27;ul&#x27;);
            for(i = (aErrorLabel2.length - 1); i &gt;= 0; i--) {
                curElm = aErrorLabel2[i];
                if(Css.hasClassName(curElm, &#x27;control-group&#x27;)) {
                    Css.removeClassName(curElm, &#x27;validation error&#x27;);
                }
            }
        },

        /**
         * Removes unnecessary spaces to the left or right of a string
         * 
         * @method _trim
         * @param {String} stri String to be trimmed
         * @private
         * @return {String|undefined} String trimmed.
         */
        _trim: function(str)
        {
            if(typeof(str) === &#x27;string&#x27;)
            {
                return str.replace(/^\s+|\s+$|\n+$/g, &#x27;&#x27;);
            }
        }
    };

    return FormValidator;

});
    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
